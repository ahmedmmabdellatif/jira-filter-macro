app:
  # The `id` field is intentionally omitted. When deploying for the first time,
  # run `forge register` or `forge deploy` to have the Forge CLI assign a unique
  # app identifier. The CLI will automatically update your manifest with the
  # generated app ID once registration completes.
  runtime:
    # Specify the Node.js runtime that backs your functions. The runtime name must
    # include an ".x" suffix; for example, use "nodejs20.x" instead of
    # "nodejs20"【748473698955597†L64-L69】.
    name: nodejs20.x

modules:
  # Define a Confluence macro module. Custom UI macros must specify a static
  # resource for the iframe content via the `resource` property【799124642826588†L109-L116】.
  confluence:macro:
    - key: jira-filter-replica-macro
      title: Jira Filter Replica
      description: A replica of the native Jira Filter macro.
      # The front‑end bundle that renders the macro. This key must correspond to
      # an entry in the top‑level `resources` section【801528993977902†L93-L98】.
      resource: main-app
      # Backend resolver invoked by the macro. Points to the function module
      # defined below.
      resolver:
        function: main-resolver
      # Configuration for the macro. Custom configuration panels must specify
      # their own static resource.
      config:
        type: custom
        resource: macro-config

  # Declare function modules. Each function has a key and a handler file.
  function:
    - key: main-resolver
      handler: index.run

# Static resources used by the macro and its configuration panel. These must be
# declared at the top level rather than under `modules`【801528993977902†L93-L98】.
resources:
  - key: main-app
    path: static/jira-macro/build
  - key: macro-config
    path: static/jira-macro/build

permissions:
  scopes:
    - read:jira-work
    - read:jira-user
  external:
    fetch:
      backend:
        - api.atlassian.com